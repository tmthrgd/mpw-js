<!doctype html>
<html lang=en>
<head>
	<meta charset=utf-8>
	<meta http-equiv=Content-Security-Policy content="default-src 'none'; style-src 'self'; script-src 'self' 'unsafe-inline' https://api.github.com https://cdnjs.cloudflare.com; img-src https://i.creativecommons.org https://licensebuttons.net; child-src 'self'">
	<!-- by Tom Thorogood <me@tomthorogood.co.uk> -->
	<!-- This work is licensed under the Creative Commons Attribution
		 4.0 International License. To view a copy of this license,
		 visit http://creativecommons.org/licenses/by/4.0/ or see LICENSE. -->
	<title>Master Password Tests</title>
	<link rel=stylesheet href=../style.css>
</head>
<body>
	<header class=page-header>
		<h1>Master Password Tests &ndash; <code>mpw-js</code></h1>
	</header>
	
	<main class=page-body>
		<div class=tests></div>
		
		<p>Passed <span class="num passed">0</span>; Failed <span class="num failed">0</span>; Skipped <span class="num skipped">0</span>; Completed <span class="num completed">0</span></p>
		
		<p>Error: <code class=error><noscript>You must have JavaScript enabled for this page to work.</noscript></code></p>
		
		<p>Test data from <a href=https://github.com/Lyndir/MasterPassword/blob/master/core/mpw_tests.xml>Lyndir/MasterPassword/core/mpw_tests.xml</a></p>
	</main>
	
	<footer class=page-footer>
		<h2>License</h2>
		
		<pre><a href=https://creativecommons.org/licenses/by/4.0/ rel=license><img alt="Creative Commons Licence" src=https://i.creativecommons.org/l/by/4.0/88x31.png></a>
<span xmlns:dct=http://purl.org/dc/terms/ property=dct:title>mpw-js</span> by <a xmlns:cc=http://creativecommons.org/ns# href=https://tomthorogood.co.uk/ property=cc:attributionName rel=cc:attributionURL>Tom Thorogood</a> is licensed under a <a rel=license href=https://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0 International License</a>.

mpw-js is a JavaScript + Web Crypto implementation of the Master Password App algorithm &lt;<a href=http://masterpasswordapp.com/algorithm.html>http://masterpasswordapp.com/algorithm.html</a>&gt;.</pre>
	</footer>
	
	<script>
	// Test for required ES6 features
	// This test must be in a seperate script tag as they are
	// language features and ES5 parsers will hard-fail otherwise
	
	// If the ES6 class, let, destructive assignment and rest arguments
	// are supported, this will be successful and ES6 files will be loaded
	// rather than the transpiled files
	class $ES6 { constructor() { let b = true; this.b = b; } }
	const [canES6] = ((...args) => args)(new $ES6().b);
	</script>
	<script>
	// If the needed ES6 features aren't supported the ES6 to ES5
	// transpiled files will be loaded instead
	var esdir = (typeof canES6 !== "undefined" && canES6) ? "" : "es5/";

	// If setImmediate is not implemented we include the polyfill
	window.setImmediate || document.write("<script src=../" + esdir + "setImmediate-polyfill.js><\/script>");
	
	// If Typed Arrays are not supported we include the polyfill
	// https://github.com/inexorabletash/polyfill
	window.ArrayBuffer || document.write("<script src=../typedarray-polyfill.js><\/script>");
	
	// If TextEncoder is not supported we include the polyfill
	// https://github.com/inexorabletash/text-encoding
	window.TextEncoder || document.write("<script src=../encoding-polyfill.js><\/script>");
	
	// If Promise is not supported we include the polyfill
	// https://github.com/taylorhakes/promise-polyfill
	window.Promise || document.write("<script src=../promise-polyfill.js><\/script>");
	
	// Alias window.crypto.subtle with window.crypto.webkitSubtle if
	// the latter but not the former is supported
	if (!window.crypto.subtle && window.crypto.webkitSubtle) {
		window.crypto.subtle = window.crypto.webkitSubtle;
	}
	
	// If Web Crypto API is not supported we include a JS crypto library
	// https://code.google.com/p/crypto-js/
	if (!window.crypto.subtle) {
		document.write("<script src=https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/hmac-sha256.js><\/script>");
		document.write("<script src=https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/pbkdf2.js><\/script>");
		document.write("<script src=https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/lib-typedarrays-min.js><\/script>");
	}
	
	// If MAX_SAFE_INTEGER (ES6) is not defined, define it
	if (!Number.MAX_SAFE_INTEGER) {
		Number.MAX_SAFE_INTEGER = Math.pow(2, 53) - 1;
	}
	
	// If your borwser needs a lot of polyfills consider upgrading
	// to a more modern feature rich browser, if you are a browser
	// developer considering adding these much needed features already!
	// :D
	
	// Include the scrypt implementation
	document.write("<script src=../" + esdir + "lib/pbkdf2.js><\/script>");
	document.write("<script src=../" + esdir + "lib/scrypt.js><\/script>");
	
	// Include the MPW class
	document.write("<script src=../" + esdir + "lib/mpw.js><\/script>");
	</script>
	<script src=test.js></script>
	<script src="https://api.github.com/repos/tmthrgd/mpw-js/contents/test/spectre_tests.xml?ref=gh-pages&amp;callback=ghcallback"></script>
</body>
</html>
